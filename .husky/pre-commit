#!/bin/sh

echo "üöî ROBOCOP: Verificando calidad de c√≥digo..."

# ============================================================================
# TypeScript - 0 errores (API)
# ============================================================================
echo "‚Üí Verificando TypeScript (API)..."
cd apps/api && npx tsc --noEmit
TS_EXIT=$?
cd ../..

if [ $TS_EXIT -ne 0 ]; then
  echo ""
  echo "‚ùå BLOQUEADO: Errores de TypeScript."
  echo "   Arreglar antes de commitear."
  echo ""
  exit 1
fi

# ============================================================================
# lint-staged (ESLint + Prettier en archivos cambiados)
# ============================================================================
echo "‚Üí Verificando c√≥digo con lint-staged..."
npx lint-staged || {
  echo ""
  echo "‚ùå BLOQUEADO: Errores de ESLint o formato."
  echo "   Arreglar antes de commitear."
  echo ""
  exit 1
}

echo ""
echo "‚úÖ ROBOCOP: Todo OK. Commit permitido."
echo ""
