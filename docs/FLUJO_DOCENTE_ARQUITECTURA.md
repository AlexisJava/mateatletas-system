# üéØ ARQUITECTURA COMPLETA - FLUJO DOCENTE

**Fecha**: 27 de Octubre 2025
**Autor**: Claude Code
**Estado**: En Implementaci√≥n

---

## üìã TABLA DE CONTENIDOS

1. [Resumen Ejecutivo](#resumen-ejecutivo)
2. [Schema de Base de Datos](#schema-de-base-de-datos)
3. [Endpoints Existentes](#endpoints-existentes)
4. [Endpoints a Crear](#endpoints-a-crear)
5. [Flujo de Usuario](#flujo-de-usuario)
6. [Plan de Implementaci√≥n](#plan-de-implementaci√≥n)

---

## üéØ RESUMEN EJECUTIVO

### Objetivo
Crear un sistema COMPLETO y ROBUSTO para que los docentes puedan:
1. Ver detalles completos de sus grupos
2. Tomar asistencia en tiempo real durante la clase
3. Agregar observaciones (grupo e individuales)
4. Asignar puntos a estudiantes
5. Ver tareas asignadas y completadas
6. Gestionar todo el ciclo de vida de una clase

### Principios de Dise√±o
- ‚úÖ **NO `any` NI `unknown`**: TypeScript estricto
- ‚úÖ **BRUTAL**: Informaci√≥n concreta, no ambigua
- ‚úÖ **DRY**: No duplicar c√≥digo
- ‚úÖ **Escalable**: Preparado para Admin ‚Üí Docente ‚Üí Estudiante ‚Üí Tutor
- ‚úÖ **Performante**: Queries optimizados con Prisma

---

## üóÑÔ∏è SCHEMA DE BASE DE DATOS

### Modelos Clave para el Flujo Docente

#### 1. **ClaseGrupo** (`clase_grupos`)
```prisma
model ClaseGrupo {
  id                  String     @id @default(cuid())
  codigo              String     // "L4", "ROBLOX1", etc.
  nombre              String     @unique
  tipo                TipoClaseGrupo
  dia_semana          DiaSemana
  hora_inicio         String     // "19:30"
  hora_fin            String     // "21:00"
  cupo_maximo         Int
  docente_id          String
  grupo_id            String
  ruta_curricular_id  String?
  sector_id           String?
  activo              Boolean

  // Relaciones
  docente             Docente
  inscripciones       InscripcionClaseGrupo[]
  asistencias         AsistenciaClaseGrupo[]
}
```

#### 2. **InscripcionClaseGrupo** (`inscripciones_clase_grupo`)
```prisma
model InscripcionClaseGrupo {
  id                String      @id @default(cuid())
  clase_grupo_id    String
  estudiante_id     String
  tutor_id          String
  fecha_inscripcion DateTime
  activo            Boolean

  // Relaciones
  claseGrupo        ClaseGrupo
  estudiante        Estudiante
  tutor             Tutor
}
```

#### 3. **AsistenciaClaseGrupo** (`asistencias_clase_grupo`)
```prisma
model AsistenciaClaseGrupo {
  id                String            @id @default(cuid())
  clase_grupo_id    String
  estudiante_id     String
  fecha             DateTime          // Fecha espec√≠fica de la clase
  estado            EstadoAsistencia  // Presente, Ausente, Justificado
  observaciones     String?           // ‚≠ê OBSERVACIONES INDIVIDUALES
  feedback          String?

  @@unique([clase_grupo_id, estudiante_id, fecha])
}
```

#### 4. **PuntoObtenido** (`puntos_obtenidos`)
```prisma
model PuntoObtenido {
  id             String   @id @default(cuid())
  estudiante_id  String
  docente_id     String
  accion_id      String   // Referencia a AccionPuntuable
  puntos         Int
  contexto       String?  // Descripci√≥n adicional
  fecha          DateTime

  // Relaciones
  estudiante     Estudiante
  docente        Docente
  accion         AccionPuntuable
}
```

#### 5. **AccionPuntuable** (`acciones_puntuables`)
```prisma
model AccionPuntuable {
  id          String  @id @default(cuid())
  nombre      String  @unique  // "Participaci√≥n activa", "Tarea completada"
  descripcion String
  puntos      Int
  activo      Boolean
}
```

#### 6. **Tarea** (`tareas`)
```prisma
model Tarea {
  id                        String      @id @default(cuid())
  evento_id                 String      @unique
  estado                    EstadoTarea // PENDIENTE, EN_PROGRESO, COMPLETADA
  porcentaje_completado     Int
  clase_relacionada_id      String?
  estudiante_relacionado_id String?

  evento                    Evento
}
```

---

## ‚úÖ ENDPOINTS EXISTENTES

### 1. **Grupos** (`/api/grupos`)
- ‚úÖ `GET /grupos` - Listar todos los grupos
- ‚úÖ `GET /grupos/:id` - Obtener un grupo espec√≠fico
- ‚úÖ `POST /grupos` - Crear grupo (Admin)
- ‚úÖ `PUT /grupos/:id` - Actualizar grupo (Admin)
- ‚úÖ `DELETE /grupos/:id` - Eliminar grupo (Admin)

### 2. **Asistencia** (`/api/asistencia`)
- ‚úÖ `POST /asistencia/clases/:claseId/estudiantes/:estudianteId` - Marcar asistencia individual
- ‚úÖ `GET /asistencia/clases/:claseId` - Obtener roster de asistencia
- ‚úÖ `GET /asistencia/clases/:claseId/estadisticas` - Estad√≠sticas de clase
- ‚úÖ `GET /asistencia/estudiantes/:estudianteId` - Historial estudiante
- ‚úÖ `GET /asistencia/docente/resumen` - Resumen del docente
- ‚úÖ `GET /asistencia/docente/observaciones` - Observaciones del docente
- ‚úÖ `GET /asistencia/docente/reportes` - Reportes del docente

### 3. **Gamificaci√≥n** (`/api/gamificacion`)
- ‚úÖ `GET /gamificacion/acciones` - Lista de acciones puntuables
- ‚úÖ `POST /gamificacion/puntos` - Otorgar puntos a estudiante
- ‚úÖ `GET /gamificacion/dashboard/:estudianteId` - Dashboard del estudiante
- ‚úÖ `GET /gamificacion/puntos/:estudianteId` - Puntos del estudiante
- ‚úÖ `GET /gamificacion/historial/:estudianteId` - Historial de puntos

### 4. **Docentes** (`/api/docentes`)
- ‚úÖ `GET /docentes/me/dashboard` - Dashboard BRUTAL con datos concretos
- ‚úÖ `GET /docentes/me` - Perfil del docente
- ‚úÖ `PATCH /docentes/me` - Actualizar perfil

---

## üöÄ ENDPOINTS A CREAR

### 1. **GET `/api/clase-grupos/:id/detalle-completo`**
**Descripci√≥n**: Obtiene TODA la informaci√≥n necesaria para la vista de detalles del grupo

**Response**:
```typescript
interface GrupoDetalleCompleto {
  // Info b√°sica del grupo
  id: string;
  nombre: string;
  codigo: string;
  dia_semana: string;
  hora_inicio: string;
  hora_fin: string;
  cupo_maximo: number;
  rutaCurricular: {
    id: string;
    nombre: string;
    color: string;
  } | null;

  // Estudiantes inscritos CON STATS
  estudiantes: Array<{
    id: string;
    nombre: string;
    apellido: string;
    avatar_url: string | null;
    equipo: {
      nombre: string;
      color: string;
    } | null;
    stats: {
      puntosTotal number;
      clasesAsistidas: number;
      porcentajeAsistencia: number;
      tareasCompletadas: number;
      tareasTotal: number;
      ultimaAsistencia: string | null;
    };
  }>;

  // Tareas del grupo
  tareas: Array<{
    id: string;
    titulo: string;
    descripcion: string;
    fecha_entrega: string;
    estado: string;
    estudiantesCompletaron: string[]; // IDs de estudiantes que completaron
    estudiantesPendientes: string[];  // IDs de estudiantes pendientes
  }>;

  // Observaciones recientes del grupo
  observacionesRecientes: Array<{
    id: string;
    estudiante: {
      id: string;
      nombre: string;
      apellido: string;
    };
    observacion: string;
    fecha: string;
    tipo: 'positiva' | 'neutral' | 'atencion';
  }>;

  // Stats del grupo
  stats: {
    totalEstudiantes: number;
    asistenciaPromedio: number;
    puntosPromedio: number;
    tareasCompletadasPromedio: number;
  };

  // Pr√≥xima clase
  proximaClase: {
    fecha: string;
    hora: string;
    minutosParaEmpezar: number | null;
  } | null;
}
```

### 2. **POST `/api/asistencia/clase-grupo/batch`**
**Descripci√≥n**: Tomar asistencia de m√∫ltiples estudiantes en una sola request (para modo "En Vivo")

**Body**:
```typescript
interface TomarAsistenciaBatchDto {
  clase_grupo_id: string;
  fecha: string; // ISO date
  asistencias: Array<{
    estudiante_id: string;
    estado: 'Presente' | 'Ausente' | 'Justificado';
    observaciones?: string;
  }>;
}
```

**Response**:
```typescript
interface AsistenciaBatchResponse {
  success: true;
  registrosCreados: number;
  registrosActualizados: number;
  estudiantes: Array<{
    estudiante_id: string;
    estado: string;
    observaciones: string | null;
  }>;
}
```

### 3. **POST `/api/clase-grupos/:id/observacion-grupo`**
**Descripci√≥n**: Agregar observaci√≥n general del grupo (no de estudiante individual)

**Body**:
```typescript
interface ObservacionGrupoDto {
  fecha: string; // ISO date
  observacion: string;
  tipo: 'general' | 'academica' | 'comportamiento';
}
```

### 4. **GET `/api/clase-grupos/:id/proxima-clase`**
**Descripci√≥n**: Obtener informaci√≥n sobre la pr√≥xima clase del grupo

**Response**:
```typescript
interface ProximaClaseInfo {
  grupoId: string;
  grupoNombre: string;
  fecha: string; // Pr√≥ximo d√≠a que coincide con dia_semana
  hora_inicio: string;
  hora_fin: string;
  minutosParaEmpezar: number | null; // null si no es hoy
  estudiantesInscritos: number;
  estudiantesPresentes: number; // Si ya se tom√≥ asistencia hoy
  yaTomoAsistencia: boolean;
}
```

---

## üë§ FLUJO DE USUARIO

### FLUJO COMPLETO DEL DOCENTE

```mermaid
graph TD
    A[Dashboard Docente] --> B{Ve sus 6 grupos}
    B --> C[Click en 'Ver Detalles' de un grupo]
    C --> D[P√°gina: Detalles del Grupo]

    D --> E[Ve lista de estudiantes con stats]
    D --> F[Ve tareas asignadas]
    D --> G[Ve observaciones recientes]
    D --> H[Ve stats del grupo]

    D --> I{Hay clase HOY?}
    I -->|S√ç| J[Bot√≥n 'INICIAR CLASE AHORA' visible]
    I -->|NO| K[Bot√≥n deshabilitado]

    J --> L[Click en 'INICIAR CLASE']
    L --> M[Modal: Toma de Asistencia EN VIVO]

    M --> N[Ve lista de estudiantes del grupo]
    N --> O[Marca Presente/Ausente/Justificado]
    N --> P[Agrega observaciones individuales]
    N --> Q[Asigna puntos r√°pidos]

    O --> R[Click 'GUARDAR ASISTENCIA']
    R --> S[POST /asistencia/clase-grupo/batch]
    S --> T[Asistencia guardada ‚úÖ]

    T --> U[Vuelve a Detalles del Grupo]
    U --> V[Ve asistencia actualizada]
```

---

## üõ†Ô∏è PLAN DE IMPLEMENTACI√ìN

### FASE 1: BACKEND - Endpoints Nuevos (1-2 horas)

#### Paso 1.1: Crear endpoint `GET /clase-grupos/:id/detalle-completo`
**Archivo**: `apps/api/src/planificaciones/infrastructure/grupos.controller.ts`

```typescript
@Get(':id/detalle-completo')
@Roles(Role.Docente, Role.Admin)
async getDetalleCompleto(
  @Param('id') id: string,
  @GetUser() user: AuthUser,
) {
  // Query complejo con Prisma
  // Include: estudiantes, inscripciones, asistencias, puntos, tareas
  // Calcular stats en el servicio
}
```

#### Paso 1.2: Crear endpoint `POST /asistencia/clase-grupo/batch`
**Archivo**: `apps/api/src/asistencia/asistencia.controller.ts`

```typescript
@Post('clase-grupo/batch')
@Roles(Role.Docente)
async tomarAsistenciaBatch(
  @Body() dto: TomarAsistenciaBatchDto,
  @GetUser() user: AuthUser,
) {
  // Usar transaction de Prisma
  // Crear o actualizar m√∫ltiples registros de asistencia
  // Verificar que el docente es el titular del grupo
}
```

#### Paso 1.3: Crear DTOs TypeScript
**Archivo**: `apps/api/src/asistencia/dto/tomar-asistencia-batch.dto.ts`

```typescript
import { IsString, IsArray, ValidateNested, IsEnum, IsOptional } from 'class-validator';
import { Type } from 'class-transformer';
import { EstadoAsistencia } from '@prisma/client';

export class AsistenciaItemDto {
  @IsString()
  estudiante_id!: string;

  @IsEnum(EstadoAsistencia)
  estado!: EstadoAsistencia;

  @IsOptional()
  @IsString()
  observaciones?: string;
}

export class TomarAsistenciaBatchDto {
  @IsString()
  clase_grupo_id!: string;

  @IsString()
  fecha!: string;

  @IsArray()
  @ValidateNested({ each: true })
  @Type(() => AsistenciaItemDto)
  asistencias!: AsistenciaItemDto[];
}
```

---

### FASE 2: FRONTEND - API Client (30 min)

#### Paso 2.1: Crear tipos TypeScript
**Archivo**: `apps/web/src/lib/api/grupos.api.ts`

```typescript
export interface EstudianteConStats {
  id: string;
  nombre: string;
  apellido: string;
  avatar_url: string | null;
  equipo: {
    nombre: string;
    color: string;
  } | null;
  stats: {
    puntosTotal: number;
    clasesAsistidas: number;
    porcentajeAsistencia: number;
    tareasCompletadas: number;
    tareasTotal: number;
    ultimaAsistencia: string | null;
  };
}

export interface TareaGrupo {
  id: string;
  titulo: string;
  descripcion: string;
  fecha_entrega: string;
  estado: string;
  estudiantesCompletaron: string[];
  estudiantesPendientes: string[];
}

export interface GrupoDetalleCompleto {
  id: string;
  nombre: string;
  codigo: string;
  dia_semana: string;
  hora_inicio: string;
  hora_fin: string;
  cupo_maximo: number;
  rutaCurricular: {
    id: string;
    nombre: string;
    color: string;
  } | null;
  estudiantes: EstudianteConStats[];
  tareas: TareaGrupo[];
  observacionesRecientes: Array<{
    id: string;
    estudiante: {
      id: string;
      nombre: string;
      apellido: string;
    };
    observacion: string;
    fecha: string;
    tipo: 'positiva' | 'neutral' | 'atencion';
  }>;
  stats: {
    totalEstudiantes: number;
    asistenciaPromedio: number;
    puntosPromedio: number;
    tareasCompletadasPromedio: number;
  };
  proximaClase: {
    fecha: string;
    hora: string;
    minutosParaEmpezar: number | null;
  } | null;
}

// Funciones API
export const gruposApi = {
  getDetalleCompleto: async (id: string): Promise<GrupoDetalleCompleto> => {
    const response = await apiClient.get<GrupoDetalleCompleto>(`/clase-grupos/${id}/detalle-completo`);
    return response;
  },
};
```

#### Paso 2.2: Crear API de asistencia batch
**Archivo**: `apps/web/src/lib/api/asistencia.api.ts` (agregar)

```typescript
export interface AsistenciaItem {
  estudiante_id: string;
  estado: 'Presente' | 'Ausente' | 'Justificado';
  observaciones?: string;
}

export interface TomarAsistenciaBatchRequest {
  clase_grupo_id: string;
  fecha: string;
  asistencias: AsistenciaItem[];
}

export const tomarAsistenciaBatch = async (
  data: TomarAsistenciaBatchRequest
): Promise<{ success: boolean; registrosCreados: number }> => {
  const response = await apiClient.post('/asistencia/clase-grupo/batch', data);
  return response;
};
```

---

### FASE 3: FRONTEND - P√°gina de Detalles BRUTAL (2-3 horas)

#### Paso 3.1: Crear p√°gina de detalles
**Archivo**: `apps/web/src/app/docente/grupos/[id]/page.tsx` (reescribir completa)

**Estructura**:
1. **Header BRUTAL**: Nombre del grupo, c√≥digo, d√≠a/hora
2. **Stats Cards**: 4 cards con totales (estudiantes, asistencia, puntos, tareas)
3. **Bot√≥n INICIAR CLASE HOY**: Solo visible si hay clase hoy
4. **Tabs**:
   - Tab 1: **ESTUDIANTES** (lista con stats, puntos, asistencia)
   - Tab 2: **TAREAS** (asignadas, completadas/pendientes)
   - Tab 3: **OBSERVACIONES** (historial de observaciones)
   - Tab 4: **ESTAD√çSTICAS** (gr√°ficos y reportes)

#### Paso 3.2: Crear modal de asistencia en vivo
**Archivo**: `apps/web/src/components/docente/ModalAsistenciaEnVivo.tsx`

**Funcionalidades**:
- Lista de estudiantes con avatares
- Botones r√°pidos: Presente / Ausente / Justificado
- Campo de observaci√≥n por estudiante
- Bot√≥n "+ PUNTOS" r√°pido (abre mini-modal)
- Contador de presentes/ausentes en tiempo real
- Bot√≥n "GUARDAR TODO" (llama al endpoint batch)

---

### FASE 4: TESTING & REFINAMIENTO (1 hora)

1. Probar flujo completo
2. Verificar performance de queries
3. Ajustar tipos TypeScript si hay errores
4. Pulir UX/UI

---

## üìä ESTIMACI√ìN DE TIEMPO

| Fase | Descripci√≥n | Tiempo Estimado |
|------|-------------|-----------------|
| Fase 1 | Backend - Endpoints nuevos | 1-2 horas |
| Fase 2 | Frontend - API Client | 30 min |
| Fase 3 | Frontend - UI/UX BRUTAL | 2-3 horas |
| Fase 4 | Testing & Refinamiento | 1 hora |
| **TOTAL** | **Implementaci√≥n completa** | **4-6 horas** |

---

## ‚úÖ CHECKLIST DE IMPLEMENTACI√ìN

### Backend
- [ ] Crear endpoint `GET /clase-grupos/:id/detalle-completo`
- [ ] Crear endpoint `POST /asistencia/clase-grupo/batch`
- [ ] Crear DTOs con class-validator
- [ ] Testear endpoints con Postman/Insomnia
- [ ] Verificar performance de queries (√≠ndices Prisma)

### Frontend
- [ ] Crear tipos TypeScript (NO `any`, NO `unknown`)
- [ ] Crear funciones API client
- [ ] Reescribir p√°gina de detalles de grupo
- [ ] Crear modal de asistencia en vivo
- [ ] Crear componente de asignaci√≥n r√°pida de puntos
- [ ] Integrar con dise√±o BRUTAL (purple, yellow, glassmorphism)

### Testing
- [ ] Probar flujo: Dashboard ‚Üí Detalles ‚Üí Iniciar Clase ‚Üí Tomar Asistencia
- [ ] Verificar que stats se actualizan en tiempo real
- [ ] Probar con datos reales (tus 6 grupos)
- [ ] Verificar que no hay errores TypeScript
- [ ] Probar responsive (mobile/tablet/desktop)

---

## üé® MOCKUP DE DISE√ëO BRUTAL

### P√°gina: Detalles del Grupo

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  ‚Üê Volver    DETALLES DEL GRUPO                            ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                             ‚îÇ
‚îÇ  üìö L4 - LUNES 17:00-19:00                                 ‚îÇ
‚îÇ  Programaci√≥n B√°sica ‚Ä¢ 15 estudiantes                      ‚îÇ
‚îÇ                                                             ‚îÇ
‚îÇ  [üöÄ INICIAR CLASE AHORA] ‚Üê Solo visible si hay clase hoy ‚îÇ
‚îÇ                                                             ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                  ‚îÇ
‚îÇ  ‚îÇ  15  ‚îÇ  ‚îÇ 95%  ‚îÇ  ‚îÇ 1250 ‚îÇ  ‚îÇ 12/15‚îÇ                  ‚îÇ
‚îÇ  ‚îÇüë•Est ‚îÇ  ‚îÇ‚úÖAsis‚îÇ  ‚îÇ‚≠êPts ‚îÇ  ‚îÇüìùTar ‚îÇ                  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                  ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                             ‚îÇ
‚îÇ  [ESTUDIANTES] [TAREAS] [OBSERVACIONES] [ESTAD√çSTICAS]    ‚îÇ
‚îÇ                                                             ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ üë§ Clara Sanchez                          1250 pts ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ    üìä 95% asistencia ‚Ä¢ 12/12 tareas ‚Ä¢ üî• 15 d√≠as   ‚îÇ   ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§   ‚îÇ
‚îÇ  ‚îÇ üë§ Sofia Rodriguez                        1100 pts ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ    üìä 90% asistencia ‚Ä¢ 11/12 tareas ‚Ä¢ üî• 10 d√≠as   ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ                                                             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üîê SEGURIDAD Y VALIDACIONES

### Backend
1. ‚úÖ Verificar que el docente autenticado sea el titular del grupo
2. ‚úÖ Validar que la fecha de asistencia sea v√°lida (no futuro lejano)
3. ‚úÖ Validar que los estudiantes pertenezcan al grupo
4. ‚úÖ Prevenir SQL injection con Prisma (ya incluido)
5. ‚úÖ Rate limiting en endpoints sensibles

### Frontend
1. ‚úÖ Validar inputs antes de enviar
2. ‚úÖ Mostrar loaders mientras se guarda
3. ‚úÖ Mostrar mensajes de error claros
4. ‚úÖ Confirmaci√≥n antes de guardar asistencia
5. ‚úÖ Deshabilitar bot√≥n de guardar mientras procesa

---

## üöÄ PR√ìXIMOS PASOS (POST-IMPLEMENTACI√ìN)

1. **Integrar con Admin**: Que el admin pueda ver y editar todo
2. **Portal de Estudiantes**: Ver sus propias stats, tareas, observaciones
3. **Portal de Tutores**: Ver progreso de sus hijos
4. **Notificaciones**: Avisar a tutores de faltas/observaciones
5. **Reportes PDF**: Exportar reportes mensuales
6. **Gr√°ficos avanzados**: Chart.js para visualizaciones

---

## üìù NOTAS IMPORTANTES

- **NO usar `any` ni `unknown`**: TypeScript estricto en TODO el c√≥digo
- **Queries optimizados**: Usar `select` y `include` de Prisma inteligentemente
- **Transacciones**: Usar `prisma.$transaction` para operaciones batch
- **√çndices**: Verificar que existan √≠ndices en `clase_grupo_id`, `estudiante_id`, `fecha`
- **Error handling**: Try/catch en TODOS los servicios con logs descriptivos

---

## üéâ RESULTADO FINAL

Un sistema COMPLETO, ROBUSTO y BRUTAL que permite a los docentes:
- ‚úÖ Ver detalles completos de sus grupos
- ‚úÖ Tomar asistencia r√°pida durante la clase
- ‚úÖ Agregar observaciones individuales y de grupo
- ‚úÖ Asignar puntos en tiempo real
- ‚úÖ Ver tareas completadas/pendientes
- ‚úÖ Tener visibilidad total del progreso del grupo

**Todo con TypeScript estricto, sin `any` ni `unknown`, siguiendo los principios SOLID y con dise√±o BRUTAL** üöÄ

---

**Documento creado por Claude Code**
**√öltima actualizaci√≥n**: 27 de Octubre 2025
